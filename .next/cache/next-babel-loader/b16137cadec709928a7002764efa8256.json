{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\myWebsite\\\\components\\\\Timeframe.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport * as d3Axis from 'd3-axis';\nimport * as d3Selection from 'd3-selection';\nimport * as d3Scale from 'd3-scale';\nimport * as d3Brush from 'd3-brush';\nimport * as d3TimeFormat from 'd3-time-format';\nimport moment from \"moment\";\n\nvar Timeframe =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Timeframe, _React$Component);\n\n  function Timeframe(props) {\n    var _this;\n\n    _classCallCheck(this, Timeframe);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Timeframe).call(this, props));\n    _this.format = \"YYYY-MM-DD\";\n    _this.createScale = _this.createScale.bind(_assertThisInitialized(_this));\n    _this.updateEnd = _this.updateEnd.bind(_assertThisInitialized(_this));\n    _this.updateStart = _this.updateStart.bind(_assertThisInitialized(_this));\n    _this.removeScaleAndZoom = _this.removeScaleAndZoom.bind(_assertThisInitialized(_this));\n    _this.updatePoints = _this.updatePoints.bind(_assertThisInitialized(_this));\n    _this.createZoom = _this.createZoom.bind(_assertThisInitialized(_this));\n    _this.scale = d3Scale.scaleTime().domain([moment(\"2018-09-01\"), moment('2019-05-20')]).range([0, _this.props.width + 150]);\n\n    _this.f = function () {\n      var _this2 = this;\n\n      d3Selection.select(\"#zoomBox\").call(this.brush.move, [this.props.start, this.props.end].map(function (ele) {\n        return _this2.scale(ele);\n      }));\n    };\n\n    _this.brush = d3Brush.brushX().extent([[0, 0], [_this.props.width + 150, 110]]).on(\"end\", function () {\n      return _this.props.updateZoom(_this.scale, _this.f.bind(_assertThisInitialized(_this)));\n    });\n    return _this;\n  }\n\n  _createClass(Timeframe, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.createScale();\n      this.createZoom();\n      var that = this;\n      d3Selection.selectAll(\"#timeFrame span\").on(\"click\", function () {\n        that.props.setFrame(this.innerHTML, that.f.bind(that));\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.removeScaleAndZoom();\n      this.createScale();\n      this.updatePoints();\n    }\n  }, {\n    key: \"removeScaleAndZoom\",\n    value: function removeScaleAndZoom() {\n      d3Selection.select(\"#timeScale\").remove();\n      d3Selection.selectAll(\".pointRow\").remove();\n      d3Selection.select(\"#zoomBrush\").selectAll(\"*\").remove();\n    }\n  }, {\n    key: \"updateStart\",\n    value: function updateStart(date) {\n      this.props.updateStart(date, this.f.bind(this));\n    }\n  }, {\n    key: \"updateEnd\",\n    value: function updateEnd(date) {\n      this.props.updateEnd(date, this.f.bind(this));\n    }\n  }, {\n    key: \"createScale\",\n    value: function createScale() {\n      var scale = d3Scale.scaleTime().domain([this.props.start, this.props.end]).range([0, this.props.width]);\n      var axis = d3Axis.axisBottom(scale);\n      var diff = Math.abs(this.props.start.diff(this.props.end, \"months\"));\n\n      if (diff <= 3) {\n        diff = Math.abs(this.props.start.diff(this.props.end, \"hours\"));\n        if (diff < 72) axis.tickFormat(d3TimeFormat.timeFormat(\"%I%p %b %f\"));else axis.tickFormat(d3TimeFormat.timeFormat(\"%b %e\"));\n      } else axis.tickFormat(d3TimeFormat.timeFormat(\"%b %Y\"));\n\n      d3Selection.select(\"#timeBox\").append(\"g\").attr(\"transform\", \"translate(150,0)\").attr(\"id\", \"timeScale\").call(axis);\n    }\n  }, {\n    key: \"createZoom\",\n    value: function createZoom() {\n      var scale = this.scale;\n      var axis = d3Axis.axisTop(scale);\n      axis.tickFormat(d3TimeFormat.timeFormat(\"%b %Y\"));\n      var brush = this.brush;\n      d3Selection.select(\"#timeBox\").append(\"g\").attr(\"id\", \"zoomBox\").attr(\"transform\", \"translate(20,30)\");\n      d3Selection.select(\"#timeBox\").append(\"g\").attr(\"transform\", \"translate(25,140)\").call(axis);\n      var zoomBrush = d3Selection.select(\"#zoomBox\");\n      zoomBrush.call(brush).call(brush.move, [this.props.start, this.props.end].map(function (ele) {\n        return scale(ele);\n      }));\n    }\n  }, {\n    key: \"updatePoints\",\n    value: function updatePoints() {\n      var profData = [];\n\n      for (var prof in this.props.data) {\n        profData.push(this.props.data[prof]);\n      }\n\n      var scale = this.scale;\n      var yScale = d3Scale.scaleLinear().domain([0, profData.length]).range([0, 100]);\n      d3Selection.select(\"#zoomBox\").selectAll(\"g [class=pointRow]\").data(profData).enter().append('g').classed(\"pointRow\", true).attr('y', function (d, i) {\n        return yScale(i);\n      });\n      d3Selection.selectAll('.pointRow').selectAll('circle [class=scalePoint]').data(function (d) {\n        return d.filter(function (ele) {\n          return ele.date !== null;\n        });\n      }).enter().append('circle').classed('scalePoint', true).attr(\"cx\", function (d) {\n        return scale(moment(d.date));\n      }).attr(\"cy\", function (d) {\n        return +this.parentNode.getAttribute('y') + 10;\n      }).attr(\"fill\", function (d) {\n        if (d.resolve === undefined) d.resolve = 'Unresolved';\n        d.resolve = d.resolve.trim();\n        if (d.resolve === 'Resolved: they get it!' || d.resolve === 'Resolved - they get it!') return '#33A532';else if (d.resolve === \"Resolved - they're still shaky\" || d.resolve === \"Resolved: they're still shaky\") return '#FAD201';else if (d.resolve.includes('Unresolved')) return '#CF142B';else return '#FAD201';\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var style = __jsx(\"style\", {\n        jsx: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, \"\\n            .scalePoint{\\n                r:3;\\n            }\\n          \\n            #timeFrame span{\\n                text-decoration:underline;\\n                color:blue;\\n                cursor:pointer;\\n            }\\n\\n            .row .border{\\n                fill:none;\\n                stroke:black;\\n              }\\n\\n              #zoomBox .selection{\\n                stroke:#EAE7DC;\\n              }\\n          \");\n\n      return __jsx(React.Fragment, null, style, __jsx(\"svg\", {\n        id: \"timeBox\",\n        width: 1100,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }), __jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        className: \"datePicker\",\n        id: \"startDate\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, \"Start Date:\", __jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }), __jsx(\"input\", {\n        type: \"date\",\n        value: this.props.start.format('YYYY-MM-DD'),\n        onChange: function onChange(date) {\n          return _this3.updateStart(date);\n        },\n        min: \"2018-09-01\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      })), __jsx(\"div\", {\n        className: \"datePicker\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, \"End Date:\", __jsx(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }), __jsx(\"input\", {\n        type: \"date\",\n        value: this.props.end.format('YYYY-MM-DD'),\n        onChange: function onChange(date) {\n          return _this3.updateEnd(date);\n        },\n        max: \"2019-05-20\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      })), __jsx(\"div\", {\n        id: \"timeFrame\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"1 day\"), \" |  \", __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"1 week\"), \" |  \", __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"1 month\"), \" |\", __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"Fall Semester\"), \" |  \", __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"Spring Semester\"), \" |  \", __jsx(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"All\")));\n    }\n  }]);\n\n  return Timeframe;\n}(React.Component);\n\nexport default Timeframe;","map":{"version":3,"sources":["C:/Users/User/Documents/myWebsite/components/Timeframe.js"],"names":["React","d3Axis","d3Selection","d3Scale","d3Brush","d3TimeFormat","moment","Timeframe","props","format","createScale","bind","updateEnd","updateStart","removeScaleAndZoom","updatePoints","createZoom","scale","scaleTime","domain","range","width","f","select","call","brush","move","start","end","map","ele","brushX","extent","on","updateZoom","that","selectAll","setFrame","innerHTML","remove","date","axis","axisBottom","diff","Math","abs","tickFormat","timeFormat","append","attr","axisTop","zoomBrush","profData","prof","data","push","yScale","scaleLinear","length","enter","classed","d","i","filter","parentNode","getAttribute","resolve","undefined","trim","includes","style","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport * as d3Axis from 'd3-axis';\r\nimport * as d3Selection from 'd3-selection';\r\nimport * as d3Scale from 'd3-scale';\r\nimport * as d3Brush from 'd3-brush';\r\nimport * as d3TimeFormat from 'd3-time-format';\r\nimport moment from \"moment\";\r\n\r\nclass Timeframe extends React.Component{\r\n\r\n    constructor(props){\r\n        super(props);\r\n        this.format = \"YYYY-MM-DD\";\r\n\r\n        this.createScale = this.createScale.bind(this);\r\n        this.updateEnd = this.updateEnd.bind(this);\r\n        this.updateStart = this.updateStart.bind(this);\r\n        this.removeScaleAndZoom = this.removeScaleAndZoom.bind(this);\r\n        this.updatePoints = this.updatePoints.bind(this);\r\n        this.createZoom = this.createZoom.bind(this);\r\n\r\n        this.scale=d3Scale.scaleTime()\r\n                .domain([moment(\"2018-09-01\"),moment('2019-05-20')])\r\n                .range([0,this.props.width+150]);\r\n\r\n        this.f = function(){\r\n            d3Selection.select(\"#zoomBox\")\r\n                .call(this.brush.move, [this.props.start,this.props.end].map(ele=>this.scale(ele)));        \r\n        }\r\n        this.brush = d3Brush.brushX()\r\n                .extent([[0,0],[this.props.width+150,110]])\r\n                .on(\"end\",()=>this.props.updateZoom(this.scale,this.f.bind(this)));\r\n    }\r\n\r\n    componentDidMount(){\r\n        this.createScale();\r\n        this.createZoom();\r\n\r\n        const that = this;\r\n        d3Selection.selectAll(\"#timeFrame span\")\r\n            .on(\"click\",function(){\r\n                that.props.setFrame(this.innerHTML,that.f.bind(that));\r\n            });\r\n    }\r\n\r\n    componentDidUpdate(){\r\n        this.removeScaleAndZoom();\r\n        this.createScale();\r\n        this.updatePoints();\r\n    }\r\n\r\n    removeScaleAndZoom(){\r\n        d3Selection.select(\"#timeScale\")\r\n            .remove();\r\n        d3Selection.selectAll(\".pointRow\")\r\n            .remove();\r\n        d3Selection.select(\"#zoomBrush\")\r\n            .selectAll(\"*\").remove();\r\n    }\r\n\r\n    updateStart(date){\r\n        this.props.updateStart(date,this.f.bind(this));\r\n    }\r\n\r\n    updateEnd(date){\r\n        this.props.updateEnd(date,this.f.bind(this));\r\n    }\r\n\r\n    createScale(){\r\n        const scale = d3Scale.scaleTime()\r\n            .domain([this.props.start,this.props.end])\r\n            .range([0,this.props.width]);\r\n\r\n        const axis = d3Axis.axisBottom(scale);\r\n\r\n        let diff = Math.abs(this.props.start.diff(this.props.end,\"months\"));\r\n\r\n        if(diff <= 3){\r\n            diff = Math.abs(this.props.start.diff(this.props.end,\"hours\"));\r\n            if(diff < 72)\r\n                axis.tickFormat(d3TimeFormat.timeFormat(\"%I%p %b %f\"));\r\n            else\r\n                axis.tickFormat(d3TimeFormat.timeFormat(\"%b %e\"));\r\n        }\r\n        else\r\n            axis.tickFormat(d3TimeFormat.timeFormat(\"%b %Y\"));\r\n\r\n\r\n        d3Selection.select(\"#timeBox\")\r\n            .append(\"g\")\r\n            .attr(\"transform\",\"translate(150,0)\")\r\n            .attr(\"id\",\"timeScale\")\r\n            .call(axis);\r\n    }\r\n\r\n    createZoom(){\r\n        const scale=this.scale;\r\n        const axis = d3Axis.axisTop(scale);\r\n        axis.tickFormat(d3TimeFormat.timeFormat(\"%b %Y\"));\r\n        const brush = this.brush;\r\n\r\n        d3Selection.select(\"#timeBox\")\r\n            .append(\"g\")\r\n            .attr(\"id\",\"zoomBox\")\r\n            .attr(\"transform\",\"translate(20,30)\");\r\n\r\n        d3Selection.select(\"#timeBox\")\r\n            .append(\"g\")\r\n            .attr(\"transform\",\"translate(25,140)\")\r\n            .call(axis);\r\n        const zoomBrush = d3Selection.select(\"#zoomBox\");\r\n\r\n        zoomBrush\r\n            .call(brush)\r\n            .call(brush.move, [this.props.start,this.props.end].map(ele=>scale(ele)));        \r\n    }\r\n\r\n    updatePoints(){\r\n        const profData = [];\r\n\r\n        for(let prof in this.props.data)\r\n            profData.push(this.props.data[prof]);\r\n\r\n        const scale = this.scale;\r\n        const yScale = d3Scale.scaleLinear()\r\n        .domain([0,profData.length])\r\n        .range([0,100]);\r\n\r\n        d3Selection.select(\"#zoomBox\")\r\n            .selectAll(\"g [class=pointRow]\")\r\n            .data(profData)\r\n            .enter()\r\n            .append('g')\r\n            .classed(\"pointRow\",true)\r\n            .attr('y',(d,i) => yScale(i));\r\n\r\n        d3Selection.selectAll('.pointRow')\r\n            .selectAll('circle [class=scalePoint]')\r\n            .data(d => d.filter(ele=>ele.date!==null))\r\n            .enter()\r\n            .append('circle')\r\n            .classed('scalePoint',true)\r\n            .attr(\"cx\",d=>scale(moment(d.date)))\r\n            .attr(\"cy\",function(d){\r\n                return +this.parentNode.getAttribute('y') + 10;\r\n            })\r\n            .attr(\"fill\",d =>{\r\n                if(d.resolve===undefined)\r\n                    d.resolve = 'Unresolved';\r\n                d.resolve = d.resolve.trim();\r\n                if(d.resolve==='Resolved: they get it!' || \r\n                    d.resolve==='Resolved - they get it!')\r\n                    return '#33A532';\r\n                else if(d.resolve===\"Resolved - they're still shaky\" || \r\n                    d.resolve===\"Resolved: they're still shaky\")\r\n                    return '#FAD201';\r\n                else if(d.resolve.includes('Unresolved'))\r\n                    return '#CF142B';\r\n                else   \r\n                    return '#FAD201';\r\n            });\r\n    }\r\n\r\n    render(){\r\n        const style = <style jsx>{`\r\n            .scalePoint{\r\n                r:3;\r\n            }\r\n          \r\n            #timeFrame span{\r\n                text-decoration:underline;\r\n                color:blue;\r\n                cursor:pointer;\r\n            }\r\n\r\n            .row .border{\r\n                fill:none;\r\n                stroke:black;\r\n              }\r\n\r\n              #zoomBox .selection{\r\n                stroke:#EAE7DC;\r\n              }\r\n          `}</style>\r\n        return(            \r\n            <>\r\n                {style}\r\n                <svg id = \"timeBox\" width={1100}>\r\n                </svg>\r\n                <br/>\r\n                <div className=\"datePicker\" id=\"startDate\">Start Date:<br/><input type='date' value={this.props.start.format('YYYY-MM-DD')} onChange={date=>this.updateStart(date)} min='2018-09-01'/></div>\r\n                <div className=\"datePicker\">End Date:<br/><input type='date' value={this.props.end.format('YYYY-MM-DD')} onChange={date=>this.updateEnd(date)} max='2019-05-20'/></div>\r\n                <div id=\"timeFrame\"><span>1 day</span> |  <span>1 week</span> |  <span>1 month</span> |  \r\n                <span>Fall Semester</span> |  <span>Spring Semester</span> |  <span>All</span></div>\r\n        </>);\r\n    }\r\n}\r\n\r\nexport default Timeframe;"]},"metadata":{},"sourceType":"module"}