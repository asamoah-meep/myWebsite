{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\myWebsite\\\\components\\\\Timeframe.js\";\nvar __jsx = React.createElement;\nimport React from 'react'; // import './App.css';\n\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport * as d3Axis from 'd3-axis';\nimport * as d3Selection from 'd3-selection';\nimport * as d3Scale from 'd3-scale';\nimport * as d3Brush from 'd3-brush';\nimport * as d3TimeFormat from 'd3-time-format';\nimport moment from \"moment\";\n\nclass Timeframe extends React.Component {\n  constructor(props) {\n    super(props);\n    this.format = \"YYYY-MM-DD\";\n    this.createScale = this.createScale.bind(this);\n    this.updateEnd = this.updateEnd.bind(this);\n    this.updateStart = this.updateStart.bind(this);\n    this.removeScaleAndZoom = this.removeScaleAndZoom.bind(this);\n    this.updatePoints = this.updatePoints.bind(this);\n    this.createZoom = this.createZoom.bind(this);\n    this.scale = d3Scale.scaleTime().domain([moment(\"2018-09-01\"), moment('2019-05-20')]).range([0, this.props.width + 150]);\n\n    this.f = function () {\n      d3Selection.select(\"#zoomBox\").call(this.brush.move, [this.props.start, this.props.end].map(ele => this.scale(ele)));\n    };\n\n    this.brush = d3Brush.brushX().extent([[0, 0], [this.props.width + 150, 120]]).on(\"end\", () => this.props.updateZoom(this.scale, this.f.bind(this)));\n  }\n\n  componentDidMount() {\n    this.createScale();\n    this.createZoom();\n    const that = this;\n    d3Selection.selectAll(\"#timeFrame span\").on(\"click\", function () {\n      that.props.setFrame(this.innerHTML, that.f.bind(that));\n    });\n  }\n\n  componentDidUpdate() {\n    this.removeScaleAndZoom();\n    this.createScale();\n    this.updatePoints();\n  }\n\n  removeScaleAndZoom() {\n    d3Selection.select(\"#timeScale\").remove();\n    d3Selection.selectAll(\".pointRow\").remove();\n    d3Selection.select(\"#zoomBrush\").selectAll(\"*\").remove();\n  }\n\n  updateStart(date) {\n    this.props.updateStart(date, this.f.bind(this));\n  }\n\n  updateEnd(date) {\n    this.props.updateEnd(date, this.f.bind(this));\n  }\n\n  createScale() {\n    const scale = d3Scale.scaleTime().domain([this.props.start, this.props.end]).range([0, this.props.width]);\n    const axis = d3Axis.axisBottom(scale);\n    let diff = Math.abs(this.props.start.diff(this.props.end, \"months\"));\n\n    if (diff <= 3) {\n      diff = Math.abs(this.props.start.diff(this.props.end, \"hours\"));\n      if (diff < 72) axis.tickFormat(d3TimeFormat.timeFormat(\"%I%p %b %f\"));else axis.tickFormat(d3TimeFormat.timeFormat(\"%b %e\"));\n    } else axis.tickFormat(d3TimeFormat.timeFormat(\"%b %Y\"));\n\n    d3Selection.select(\"#timeBox\").append(\"g\").attr(\"transform\", \"translate(150,0)\").attr(\"id\", \"timeScale\").call(axis);\n  }\n\n  createZoom() {\n    const scale = this.scale;\n    const axis = d3Axis.axisTop(scale);\n    axis.tickFormat(d3TimeFormat.timeFormat(\"%b %Y\"));\n    const brush = this.brush;\n    d3Selection.select(\"#timeBox\").append(\"g\").attr(\"id\", \"zoomBox\").attr(\"transform\", \"translate(20,30)\");\n    d3Selection.select(\"#timeBox\").append(\"g\").attr(\"transform\", \"translate(25,140)\").call(axis);\n    const zoomBrush = d3Selection.select(\"#zoomBox\");\n    zoomBrush.call(brush).call(brush.move, [this.props.start, this.props.end].map(ele => scale(ele)));\n  }\n\n  updatePoints() {\n    const profData = [];\n\n    for (let prof in this.props.data) profData.push(this.props.data[prof]);\n\n    const scale = this.scale;\n    const yScale = d3Scale.scaleLinear().domain([0, profData.length]).range([0, 100]);\n    d3Selection.select(\"#zoomBox\").selectAll(\"g [class=pointRow]\").data(profData).enter().append('g').classed(\"pointRow\", true).attr('y', (d, i) => yScale(i));\n    d3Selection.selectAll('.pointRow').selectAll('circle [class=scalePoint]').data(d => d.filter(ele => ele.date !== null)).enter().append('circle').classed('scalePoint', true).attr(\"cx\", d => scale(moment(d.date))).attr(\"cy\", function (d) {\n      return +this.parentNode.getAttribute('y') + 10;\n    }).attr(\"fill\", d => {\n      if (d.resolve === undefined) d.resolve = 'Unresolved';\n      d.resolve = d.resolve.trim();\n      if (d.resolve === 'Resolved: they get it!' || d.resolve === 'Resolved - they get it!') return '#33A532';else if (d.resolve === \"Resolved - they're still shaky\" || d.resolve === \"Resolved: they're still shaky\") return '#FAD201';else if (d.resolve.includes('Unresolved')) return '#CF142B';else return '#FAD201';\n    });\n  }\n\n  render() {\n    const style = __jsx(\"style\", {\n      jsx: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, `\n            .scalePoint{\n                r:3;\n            }\n          \n            #timeFrame span{\n                text-decoration:underline;\n                color:blue;\n                cursor:pointer;\n            }\n\n            .row .border{\n                fill:none;\n                stroke:black;\n              }\n\n              #zoomBox .selection{\n                stroke:#EAE7DC;\n              }\n          `);\n\n    console.log(this.props.start.toDate().toString());\n    return __jsx(React.Fragment, null, style, __jsx(\"svg\", {\n      id: \"timeBox\",\n      width: 1100,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: \"datePicker\",\n      id: \"startDate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, \"Start Date:\", __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }), __jsx(\"input\", {\n      type: \"date\",\n      value: this.props.start.toDate().toString(),\n      onChange: date => this.updateStart(date),\n      min: \"2018-09-01\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      className: \"datePicker\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, \"End Date:\", __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }), __jsx(\"input\", {\n      type: \"date\",\n      value: this.props.end.toDate().toString(),\n      onChange: date => this.updateEnd(date),\n      max: \"2019-05-20\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      id: \"timeFrame\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, __jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, \"1 day\"), \" |  \", __jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, \"1 week\"), \" |  \", __jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, \"1 month\"), \" |\", __jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"Fall Semester\"), \" |  \", __jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"Spring Semester\"), \" |  \", __jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"All\")));\n  }\n\n}\n\nexport default Timeframe;","map":{"version":3,"sources":["C:/Users/User/Documents/myWebsite/components/Timeframe.js"],"names":["React","DatePicker","d3Axis","d3Selection","d3Scale","d3Brush","d3TimeFormat","moment","Timeframe","Component","constructor","props","format","createScale","bind","updateEnd","updateStart","removeScaleAndZoom","updatePoints","createZoom","scale","scaleTime","domain","range","width","f","select","call","brush","move","start","end","map","ele","brushX","extent","on","updateZoom","componentDidMount","that","selectAll","setFrame","innerHTML","componentDidUpdate","remove","date","axis","axisBottom","diff","Math","abs","tickFormat","timeFormat","append","attr","axisTop","zoomBrush","profData","prof","data","push","yScale","scaleLinear","length","enter","classed","d","i","filter","parentNode","getAttribute","resolve","undefined","trim","includes","render","style","console","log","toDate","toString"],"mappings":"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","sourcesContent":["import React from 'react';\r\n// import './App.css';\r\nimport DatePicker from \"react-datepicker\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport * as d3Axis from 'd3-axis';\r\nimport * as d3Selection from 'd3-selection';\r\nimport * as d3Scale from 'd3-scale';\r\nimport * as d3Brush from 'd3-brush';\r\nimport * as d3TimeFormat from 'd3-time-format';\r\nimport moment from \"moment\";\r\n\r\nclass Timeframe extends React.Component{\r\n\r\n    constructor(props){\r\n        super(props);\r\n        this.format = \"YYYY-MM-DD\";\r\n\r\n        this.createScale = this.createScale.bind(this);\r\n        this.updateEnd = this.updateEnd.bind(this);\r\n        this.updateStart = this.updateStart.bind(this);\r\n        this.removeScaleAndZoom = this.removeScaleAndZoom.bind(this);\r\n        this.updatePoints = this.updatePoints.bind(this);\r\n        this.createZoom = this.createZoom.bind(this);\r\n\r\n        this.scale=d3Scale.scaleTime()\r\n                .domain([moment(\"2018-09-01\"),moment('2019-05-20')])\r\n                .range([0,this.props.width+150]);\r\n\r\n        this.f = function(){\r\n            d3Selection.select(\"#zoomBox\")\r\n                .call(this.brush.move, [this.props.start,this.props.end].map(ele=>this.scale(ele)));        \r\n        }\r\n        this.brush = d3Brush.brushX()\r\n                .extent([[0,0],[this.props.width+150,120]])\r\n                .on(\"end\",()=>this.props.updateZoom(this.scale,this.f.bind(this)));\r\n    }\r\n\r\n    componentDidMount(){\r\n        this.createScale();\r\n        this.createZoom();\r\n\r\n        const that = this;\r\n        d3Selection.selectAll(\"#timeFrame span\")\r\n            .on(\"click\",function(){\r\n                that.props.setFrame(this.innerHTML,that.f.bind(that));\r\n            });\r\n    }\r\n\r\n    componentDidUpdate(){\r\n        this.removeScaleAndZoom();\r\n        this.createScale();\r\n        this.updatePoints();\r\n    }\r\n\r\n    removeScaleAndZoom(){\r\n        d3Selection.select(\"#timeScale\")\r\n            .remove();\r\n        d3Selection.selectAll(\".pointRow\")\r\n            .remove();\r\n        d3Selection.select(\"#zoomBrush\")\r\n            .selectAll(\"*\").remove();\r\n    }\r\n\r\n    updateStart(date){\r\n        this.props.updateStart(date,this.f.bind(this));\r\n    }\r\n\r\n    updateEnd(date){\r\n        this.props.updateEnd(date,this.f.bind(this));\r\n    }\r\n\r\n    createScale(){\r\n        const scale = d3Scale.scaleTime()\r\n            .domain([this.props.start,this.props.end])\r\n            .range([0,this.props.width]);\r\n\r\n        const axis = d3Axis.axisBottom(scale);\r\n\r\n        let diff = Math.abs(this.props.start.diff(this.props.end,\"months\"));\r\n\r\n        if(diff <= 3){\r\n            diff = Math.abs(this.props.start.diff(this.props.end,\"hours\"));\r\n            if(diff < 72)\r\n                axis.tickFormat(d3TimeFormat.timeFormat(\"%I%p %b %f\"));\r\n            else\r\n                axis.tickFormat(d3TimeFormat.timeFormat(\"%b %e\"));\r\n        }\r\n        else\r\n            axis.tickFormat(d3TimeFormat.timeFormat(\"%b %Y\"));\r\n\r\n\r\n        d3Selection.select(\"#timeBox\")\r\n            .append(\"g\")\r\n            .attr(\"transform\",\"translate(150,0)\")\r\n            .attr(\"id\",\"timeScale\")\r\n            .call(axis);\r\n    }\r\n\r\n    createZoom(){\r\n        const scale=this.scale;\r\n        const axis = d3Axis.axisTop(scale);\r\n        axis.tickFormat(d3TimeFormat.timeFormat(\"%b %Y\"));\r\n        const brush = this.brush;\r\n\r\n        d3Selection.select(\"#timeBox\")\r\n            .append(\"g\")\r\n            .attr(\"id\",\"zoomBox\")\r\n            .attr(\"transform\",\"translate(20,30)\");\r\n\r\n        d3Selection.select(\"#timeBox\")\r\n            .append(\"g\")\r\n            .attr(\"transform\",\"translate(25,140)\")\r\n            .call(axis);\r\n        const zoomBrush = d3Selection.select(\"#zoomBox\");\r\n\r\n        zoomBrush\r\n            .call(brush)\r\n            .call(brush.move, [this.props.start,this.props.end].map(ele=>scale(ele)));        \r\n    }\r\n\r\n    updatePoints(){\r\n        const profData = [];\r\n\r\n        for(let prof in this.props.data)\r\n            profData.push(this.props.data[prof]);\r\n\r\n        const scale = this.scale;\r\n        const yScale = d3Scale.scaleLinear()\r\n        .domain([0,profData.length])\r\n        .range([0,100]);\r\n\r\n        d3Selection.select(\"#zoomBox\")\r\n            .selectAll(\"g [class=pointRow]\")\r\n            .data(profData)\r\n            .enter()\r\n            .append('g')\r\n            .classed(\"pointRow\",true)\r\n            .attr('y',(d,i) => yScale(i));\r\n\r\n        d3Selection.selectAll('.pointRow')\r\n            .selectAll('circle [class=scalePoint]')\r\n            .data(d => d.filter(ele=>ele.date!==null))\r\n            .enter()\r\n            .append('circle')\r\n            .classed('scalePoint',true)\r\n            .attr(\"cx\",d=>scale(moment(d.date)))\r\n            .attr(\"cy\",function(d){\r\n                return +this.parentNode.getAttribute('y') + 10;\r\n            })\r\n            .attr(\"fill\",d =>{\r\n                if(d.resolve===undefined)\r\n                    d.resolve = 'Unresolved';\r\n                d.resolve = d.resolve.trim();\r\n                if(d.resolve==='Resolved: they get it!' || \r\n                    d.resolve==='Resolved - they get it!')\r\n                    return '#33A532';\r\n                else if(d.resolve===\"Resolved - they're still shaky\" || \r\n                    d.resolve===\"Resolved: they're still shaky\")\r\n                    return '#FAD201';\r\n                else if(d.resolve.includes('Unresolved'))\r\n                    return '#CF142B';\r\n                else   \r\n                    return '#FAD201';\r\n            });\r\n    }\r\n\r\n    render(){\r\n        const style = <style jsx>{`\r\n            .scalePoint{\r\n                r:3;\r\n            }\r\n          \r\n            #timeFrame span{\r\n                text-decoration:underline;\r\n                color:blue;\r\n                cursor:pointer;\r\n            }\r\n\r\n            .row .border{\r\n                fill:none;\r\n                stroke:black;\r\n              }\r\n\r\n              #zoomBox .selection{\r\n                stroke:#EAE7DC;\r\n              }\r\n          `}</style>\r\n\r\n          console.log(this.props.start.toDate().toString());\r\n        return(            \r\n            <>\r\n                {style}\r\n                <svg id = \"timeBox\" width={1100}>\r\n                </svg>\r\n                <br/>\r\n                <div className=\"datePicker\" id=\"startDate\">Start Date:<br/><input type='date' value={this.props.start.toDate().toString()} onChange={date=>this.updateStart(date)} min='2018-09-01'/></div>\r\n                <div className=\"datePicker\">End Date:<br/><input type='date' value={this.props.end.toDate().toString()} onChange={date=>this.updateEnd(date)} max='2019-05-20'/></div>\r\n                <div id=\"timeFrame\"><span>1 day</span> |  <span>1 week</span> |  <span>1 month</span> |  \r\n                <span>Fall Semester</span> |  <span>Spring Semester</span> |  <span>All</span></div>\r\n        </>);\r\n    }\r\n}\r\n\r\nexport default Timeframe;"]},"metadata":{},"sourceType":"module"}